

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyrocko.moment_tensor &mdash; Pyrocko v0.3 Manual</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Pyrocko v0.3 Manual"
          href="../../_static/opensearch.xml"/>
    <link rel="top" title="Pyrocko v0.3 Manual" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Pyrocko v0.3 Manual</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <h1>Source code for pyrocko.moment_tensor</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">num</span>

<span class="kn">from</span> <span class="nn">pyrocko.guts</span> <span class="kn">import</span> <span class="n">Object</span><span class="p">,</span> <span class="n">Float</span>

<span class="n">guts_prefix</span> <span class="o">=</span> <span class="s">&#39;pf&#39;</span>

<span class="n">dynecm</span> <span class="o">=</span> <span class="mf">1e-7</span>

<span class="k">def</span> <span class="nf">rotation_from_axis_and_angle</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">axis</span>
        <span class="n">ux</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
        <span class="n">uy</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
        <span class="n">uz</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">uabs</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">ux</span><span class="p">,</span> <span class="n">uy</span><span class="p">,</span> <span class="n">uz</span> <span class="o">=</span> <span class="n">axis</span> <span class="o">/</span> <span class="n">uabs</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">False</span>

    <span class="n">ct</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">num</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span>
        <span class="p">[</span><span class="n">ct</span> <span class="o">+</span> <span class="n">ux</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">ct</span><span class="p">),</span> <span class="n">ux</span><span class="o">*</span><span class="n">uy</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">ct</span><span class="p">)</span><span class="o">-</span><span class="n">uz</span><span class="o">*</span><span class="n">st</span><span class="p">,</span> <span class="n">ux</span><span class="o">*</span><span class="n">uz</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">ct</span><span class="p">)</span><span class="o">+</span><span class="n">uy</span><span class="o">*</span><span class="n">st</span><span class="p">],</span>
        <span class="p">[</span><span class="n">uy</span><span class="o">*</span><span class="n">ux</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">ct</span><span class="p">)</span><span class="o">+</span><span class="n">uz</span><span class="o">*</span><span class="n">st</span><span class="p">,</span> <span class="n">ct</span><span class="o">+</span><span class="n">uy</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">ct</span><span class="p">),</span> <span class="n">uy</span><span class="o">*</span><span class="n">uz</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">ct</span><span class="p">)</span><span class="o">-</span><span class="n">ux</span><span class="o">*</span><span class="n">st</span><span class="p">],</span>
        <span class="p">[</span><span class="n">uz</span><span class="o">*</span><span class="n">ux</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">ct</span><span class="p">)</span><span class="o">-</span><span class="n">uy</span><span class="o">*</span><span class="n">st</span><span class="p">,</span> <span class="n">uz</span><span class="o">*</span><span class="n">uy</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">ct</span><span class="p">)</span><span class="o">+</span><span class="n">ux</span><span class="o">*</span><span class="n">st</span><span class="p">,</span> <span class="n">ct</span><span class="o">+</span><span class="n">uz</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">ct</span><span class="p">)]</span>
        <span class="p">])</span>

<span class="k">def</span> <span class="nf">random_rotation</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

    <span class="c"># after Arvo 1992 - &quot;Fast random rotation matrices&quot;</span>

    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="n">phi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">2.0</span><span class="o">*</span><span class="n">x1</span>

    <span class="n">zrot</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span>
            <span class="p">[</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="mf">0.</span><span class="p">],</span>
            <span class="p">[</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="mf">0.</span><span class="p">],</span>
            <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>

    <span class="n">lam</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">2.0</span><span class="o">*</span><span class="n">x2</span>

    <span class="n">v</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span> 
        <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x3</span><span class="p">),</span> 
        <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x3</span><span class="p">),</span> 
        <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">x3</span><span class="p">)</span> <span class="p">]])</span><span class="o">.</span><span class="n">T</span>

    <span class="n">house</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">v</span> <span class="o">*</span> <span class="n">v</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">house</span><span class="o">*</span><span class="n">zrot</span>

<span class="k">def</span> <span class="nf">rand</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">ma</span><span class="p">):</span>
    <span class="n">mi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
    <span class="n">ma</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="n">ma</span><span class="o">-</span><span class="n">mi</span><span class="p">)</span> <span class="o">+</span> <span class="n">mi</span>

<span class="k">def</span> <span class="nf">randdip</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">ma</span><span class="p">):</span>
    <span class="n">mi_</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">mi</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span>
    <span class="n">ma_</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ma</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">rand</span><span class="p">(</span><span class="n">mi_</span><span class="p">,</span> <span class="n">ma_</span><span class="p">)</span><span class="o">*</span><span class="mf">2.</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="mf">180.</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span>

<span class="k">def</span> <span class="nf">random_strike_dip_rake</span><span class="p">(</span>
        <span class="n">strikemin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">strikemax</span><span class="o">=</span><span class="mf">360.</span><span class="p">,</span>
        <span class="n">dipmin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">dipmax</span><span class="o">=</span><span class="mf">90.</span><span class="p">,</span>
        <span class="n">rakemin</span><span class="o">=-</span><span class="mf">180.</span><span class="p">,</span> <span class="n">rakemax</span><span class="o">=</span><span class="mf">180.</span><span class="p">):</span>

    <span class="n">strike</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="n">strikemin</span><span class="p">,</span> <span class="n">strikemax</span><span class="p">)</span>
    <span class="n">dip</span> <span class="o">=</span> <span class="n">randdip</span><span class="p">(</span><span class="n">dipmin</span><span class="p">,</span> <span class="n">dipmax</span><span class="p">)</span>
    <span class="n">rake</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="n">rakemin</span><span class="p">,</span> <span class="n">rakemax</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">strike</span><span class="p">,</span> <span class="n">dip</span><span class="p">,</span> <span class="n">rake</span>

<span class="k">def</span> <span class="nf">to6</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">num</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">symmat6</span><span class="p">(</span><span class="o">*</span><span class="n">vals</span><span class="p">):</span>
<div class="viewcode-block" id="symmat6"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.symmat6">[docs]</a>    <span class="sd">&#39;&#39;&#39;Create symmetric 3x3 matrix from its 6 non-redundant values.</span>

<span class="sd">    vals = [ Axx, Ayy, Azz, Axy, Axz, Ayz ]&#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="n">num</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vals</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">vals</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span>
                       <span class="p">[</span><span class="n">vals</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vals</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span>
                       <span class="p">[</span><span class="n">vals</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">vals</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">num</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">values_to_matrix</span><span class="p">(</span><span class="n">values</span><span class="p">):</span></div>
<div class="viewcode-block" id="values_to_matrix"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.values_to_matrix">[docs]</a>    <span class="sd">&#39;&#39;&#39;Convert anything to moment tensor represented as a NumPy matrix.</span>

<span class="sd">    Transforms :py:class:`MomentTensor` objects, tuples, lists and NumPy arrays</span>
<span class="sd">    with 3x3 or 3, 4, 6, or 7 elements into NumPy 3x3 matrix objects.</span>

<span class="sd">    The following parameter sequences and objects are supported::</span>

<span class="sd">        [strike, dip, rake]</span>
<span class="sd">        [strike, dip, rake, magnitude]</span>
<span class="sd">        [mnn, mee, mdd, mne, mnd, med]</span>
<span class="sd">        [mnn, mee, mdd, mne, mnd, med, magnitude]</span>
<span class="sd">        [[mnn, mne, mnd], [mne, mee, med], [mnd, med, mdd]]</span>
<span class="sd">        MomentTensor_object</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">num</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">MomentTensor</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">values</span><span class="o">.</span><span class="n">m</span><span class="p">()</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">num</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,):</span>
            <span class="n">strike</span><span class="p">,</span> <span class="n">dip</span><span class="p">,</span> <span class="n">rake</span> <span class="o">=</span> <span class="n">values</span>
            <span class="n">rotmat1</span> <span class="o">=</span> <span class="n">euler_to_matrix</span><span class="p">(</span><span class="n">d2r</span><span class="o">*</span><span class="n">dip</span><span class="p">,</span> <span class="n">d2r</span><span class="o">*</span><span class="n">strike</span><span class="p">,</span> <span class="o">-</span><span class="n">d2r</span><span class="o">*</span><span class="n">rake</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">rotmat1</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">MomentTensor</span><span class="o">.</span><span class="n">_m_unrot</span> <span class="o">*</span> <span class="n">rotmat1</span>

        <span class="k">elif</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">4</span><span class="p">,):</span>
            <span class="n">strike</span><span class="p">,</span> <span class="n">dip</span><span class="p">,</span> <span class="n">rake</span><span class="p">,</span> <span class="n">magnitude</span> <span class="o">=</span> <span class="n">values</span>
            <span class="n">moment</span> <span class="o">=</span> <span class="n">magnitude_to_moment</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span>
            <span class="n">rotmat1</span> <span class="o">=</span> <span class="n">euler_to_matrix</span><span class="p">(</span><span class="n">d2r</span><span class="o">*</span><span class="n">dip</span><span class="p">,</span> <span class="n">d2r</span><span class="o">*</span><span class="n">strike</span><span class="p">,</span> <span class="o">-</span><span class="n">d2r</span><span class="o">*</span><span class="n">rake</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">rotmat1</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">MomentTensor</span><span class="o">.</span><span class="n">_m_unrot</span> <span class="o">*</span> <span class="n">rotmat1</span> <span class="o">*</span> <span class="n">moment</span>

        <span class="k">elif</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">6</span><span class="p">,):</span>
            <span class="k">return</span> <span class="n">symmat6</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">7</span><span class="p">,):</span>
            <span class="n">magnitude</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
            <span class="n">moment</span> <span class="o">=</span> <span class="n">magnitude_to_moment</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span>
            <span class="n">mt</span> <span class="o">=</span> <span class="n">symmat6</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">[:</span><span class="mi">6</span><span class="p">])</span>
            <span class="n">mt</span> <span class="o">*=</span> <span class="n">moment</span> <span class="o">/</span> <span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mt</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">mt</span>

        <span class="k">elif</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">num</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">num</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>

    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;cannot convert object to 3x3 matrix&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">moment_to_magnitude</span><span class="p">(</span> <span class="n">moment</span> <span class="p">):</span></div>
    <span class="k">return</span> <span class="n">num</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">moment</span><span class="o">*</span><span class="mf">1.0e7</span><span class="p">)</span><span class="o">/</span><span class="mf">1.5</span> <span class="o">-</span> <span class="mf">10.7</span>
    <span class="c"># global CMT uses 10.7333333... instead of 10.7, based on [Kanamori 1977]</span>
    <span class="c"># 10.7 comes from [Hanks and Kanamori 1979]</span>

<span class="k">def</span> <span class="nf">magnitude_to_moment</span><span class="p">(</span> <span class="n">magnitude</span> <span class="p">):</span>
    <span class="k">return</span> <span class="mf">10.0</span><span class="o">**</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="p">(</span><span class="n">magnitude</span><span class="o">+</span><span class="mf">10.7</span><span class="p">))</span><span class="o">*</span><span class="mf">1.0e-7</span>

<span class="n">magnitude_1Nm</span> <span class="o">=</span> <span class="n">moment_to_magnitude</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">euler_to_matrix</span><span class="p">(</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span> <span class="p">):</span>
<div class="viewcode-block" id="euler_to_matrix"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.euler_to_matrix">[docs]</a>    <span class="sd">&#39;&#39;&#39;Given the euler angles alpha,beta,gamma, create rotation matrix</span>
<span class="sd">        </span>
<span class="sd">    Given coordinate system (x,y,z) and rotated system (xs,ys,zs)</span>
<span class="sd">    the line of nodes is the intersection between the x-y and the xs-ys</span>
<span class="sd">    planes.</span>
<span class="sd">    </span>
<span class="sd">    :param alpha: is the angle between the z-axis and the zs-axis [rad]</span>
<span class="sd">    :param beta:  is the angle between the x-axis and the line of nodes [rad]</span>
<span class="sd">    :param gamma: is the angle between the line of nodes and the xs-axis [rad]</span>

<span class="sd">    Usage for moment tensors::</span>

<span class="sd">        m_unrot = numpy.matrix([[0,0,-1],[0,0,0],[-1,0,0]])</span>
<span class="sd">        euler_to_matrix(dip,strike,-rake, rotmat)</span>
<span class="sd">        m = rotmat.T * m_unrot * rotmat</span>

<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">ca</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
    <span class="n">cg</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span>
    <span class="n">sa</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">sb</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
    <span class="n">sg</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span>

    <span class="n">mat</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="p">[[</span><span class="n">cb</span><span class="o">*</span><span class="n">cg</span><span class="o">-</span><span class="n">ca</span><span class="o">*</span><span class="n">sb</span><span class="o">*</span><span class="n">sg</span><span class="p">,</span>  <span class="n">sb</span><span class="o">*</span><span class="n">cg</span><span class="o">+</span><span class="n">ca</span><span class="o">*</span><span class="n">cb</span><span class="o">*</span><span class="n">sg</span><span class="p">,</span>  <span class="n">sa</span><span class="o">*</span><span class="n">sg</span><span class="p">],</span>
                       <span class="p">[</span><span class="o">-</span><span class="n">cb</span><span class="o">*</span><span class="n">sg</span><span class="o">-</span><span class="n">ca</span><span class="o">*</span><span class="n">sb</span><span class="o">*</span><span class="n">cg</span><span class="p">,</span> <span class="o">-</span><span class="n">sb</span><span class="o">*</span><span class="n">sg</span><span class="o">+</span><span class="n">ca</span><span class="o">*</span><span class="n">cb</span><span class="o">*</span><span class="n">cg</span><span class="p">,</span> <span class="n">sa</span><span class="o">*</span><span class="n">cg</span><span class="p">],</span>
                       <span class="p">[</span><span class="n">sa</span><span class="o">*</span><span class="n">sb</span><span class="p">,</span>           <span class="o">-</span><span class="n">sa</span><span class="o">*</span><span class="n">cb</span><span class="p">,</span>          <span class="n">ca</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">num</span><span class="o">.</span><span class="n">float</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">mat</span>


<span class="k">def</span> <span class="nf">matrix_to_euler</span><span class="p">(</span> <span class="n">rotmat</span> <span class="p">):</span></div>
<div class="viewcode-block" id="matrix_to_euler"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.matrix_to_euler">[docs]</a>    <span class="sd">&#39;&#39;&#39;Inverse of euler_to_matrix().&#39;&#39;&#39;</span>
    
    <span class="n">ex</span> <span class="o">=</span> <span class="n">cvec</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span>
    <span class="n">ez</span> <span class="o">=</span> <span class="n">cvec</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span>
    <span class="n">exs</span> <span class="o">=</span> <span class="n">rotmat</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">ex</span>
    <span class="n">ezs</span> <span class="o">=</span> <span class="n">rotmat</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">ez</span>
    <span class="n">enodes</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">ez</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">ezs</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="k">if</span> <span class="n">num</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">enodes</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span>
        <span class="n">enodes</span> <span class="o">=</span> <span class="n">exs</span>
    <span class="n">enodess</span> <span class="o">=</span> <span class="n">rotmat</span><span class="o">*</span><span class="n">enodes</span>
    <span class="n">cos_alpha</span> <span class="o">=</span> <span class="nb">float</span><span class="p">((</span><span class="n">ez</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">ezs</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">cos_alpha</span> <span class="o">&gt;</span> <span class="mf">1.</span><span class="p">:</span> <span class="n">cos_alpha</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="k">if</span> <span class="n">cos_alpha</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.</span><span class="p">:</span> <span class="n">cos_alpha</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">cos_alpha</span><span class="p">)</span>
    <span class="n">beta</span>  <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span> <span class="n">enodes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">enodes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">2.</span> <span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span> <span class="n">enodess</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">enodess</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">2.</span> <span class="p">)</span>
    
    <span class="k">return</span> <span class="n">unique_euler</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">beta</span><span class="p">,</span><span class="n">gamma</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">unique_euler</span><span class="p">(</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span> <span class="p">):</span></div>
<div class="viewcode-block" id="unique_euler"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.unique_euler">[docs]</a>    <span class="sd">&#39;&#39;&#39;Uniquify euler angle triplet.</span>
<span class="sd">    </span>
<span class="sd">Put euler angles into ranges compatible with (dip,strike,-rake) in seismology:</span>
<span class="sd">    </span>
<span class="sd">    alpha (dip)   : [0, pi/2]</span>
<span class="sd">    beta (strike) : [0, 2*pi)</span>
<span class="sd">    gamma (-rake) : [-pi, pi)</span>
<span class="sd">    </span>
<span class="sd">If alpha is near to zero, beta is replaced by beta+gamma and gamma is set to</span>
<span class="sd">zero, to prevent that additional ambiguity.</span>

<span class="sd">If alpha is near to pi/2, beta is put into the range [0,pi).&#39;&#39;&#39;</span>
    
    <span class="n">pi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> 
    
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span> <span class="n">alpha</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span> <span class="p">)</span>
    
    <span class="k">if</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">pi</span> <span class="o">&lt;</span> <span class="n">alpha</span> <span class="ow">and</span> <span class="n">alpha</span> <span class="o">&lt;=</span> <span class="n">pi</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">-</span> <span class="n">alpha</span>
        <span class="n">beta</span>  <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">pi</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span> <span class="o">-</span> <span class="n">gamma</span>
    <span class="k">elif</span> <span class="n">pi</span> <span class="o">&lt;</span> <span class="n">alpha</span> <span class="ow">and</span> <span class="n">alpha</span> <span class="o">&lt;=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">pi</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">-</span> <span class="n">pi</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">-</span> <span class="n">gamma</span>
    <span class="k">elif</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">pi</span> <span class="o">&lt;</span> <span class="n">alpha</span> <span class="ow">and</span> <span class="n">alpha</span> <span class="o">&lt;=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span> <span class="o">-</span> <span class="n">alpha</span>
        <span class="n">beta</span>  <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">pi</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">+</span> <span class="n">gamma</span>
    
   
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span> <span class="n">alpha</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span> <span class="p">)</span>
    <span class="n">beta</span>  <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span> <span class="n">beta</span><span class="p">,</span>  <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span> <span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span> <span class="n">gamma</span><span class="o">+</span><span class="n">pi</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span> <span class="p">)</span><span class="o">-</span><span class="n">pi</span>
    
    <span class="c"># If dip is exactly 90 degrees, one is still</span>
    <span class="c"># free to choose between looking at the plane from either side.</span>
    <span class="c"># Choose to look at such that beta is in the range [0,180)</span>
    
    <span class="c"># This should prevent some problems, when dip is close to 90 degrees:</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">pi</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="n">pi</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">pi</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="mf">2.</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.</span>
    
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">==</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">pi</span> <span class="ow">and</span> <span class="n">beta</span> <span class="o">&gt;=</span> <span class="n">pi</span><span class="p">:</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="o">-</span> <span class="n">gamma</span>
        <span class="n">beta</span>  <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span> <span class="n">beta</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span>  <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span> <span class="p">)</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span> <span class="n">gamma</span><span class="o">+</span><span class="n">pi</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span> <span class="p">)</span><span class="o">-</span><span class="n">pi</span>
        <span class="k">assert</span> <span class="mf">0.</span> <span class="o">&lt;=</span> <span class="n">beta</span> <span class="o">&lt;</span> <span class="n">pi</span>
        <span class="k">assert</span> <span class="o">-</span><span class="n">pi</span> <span class="o">&lt;=</span> <span class="n">gamma</span> <span class="o">&lt;</span> <span class="n">pi</span>
        
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mf">1e-7</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">beta</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">cvec</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">):</span></div>
    <span class="k">return</span> <span class="n">num</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="p">[[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">num</span><span class="o">.</span><span class="n">float</span> <span class="p">)</span><span class="o">.</span><span class="n">T</span>

<span class="k">def</span> <span class="nf">rvec</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">num</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="p">[[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">num</span><span class="o">.</span><span class="n">float</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">eigh_check</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">evals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">evals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">evals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span>

<span class="n">r2d</span> <span class="o">=</span> <span class="mf">180.</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span>
<span class="n">d2r</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">r2d</span>


<span class="k">def</span> <span class="nf">random_mt</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scalar_moment</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">magnitude</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">magnitude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">scalar_moment</span> <span class="o">=</span> <span class="n">magnitude_to_moment</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

    <span class="n">evals</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mf">2.</span> <span class="o">-</span> <span class="mf">1.0</span>
    <span class="n">evals</span> <span class="o">/=</span> <span class="n">num</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">evals</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">rotmat</span> <span class="o">=</span> <span class="n">random_rotation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
    <span class="k">return</span> <span class="n">rotmat</span> <span class="o">*</span> <span class="n">num</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">evals</span><span class="p">))</span> <span class="o">*</span> <span class="n">rotmat</span><span class="o">.</span><span class="n">T</span>


<span class="k">def</span> <span class="nf">random_m6</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">to6</span><span class="p">(</span><span class="n">random_mt</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">random_dc</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scalar_moment</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">magnitude</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">magnitude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">scalar_moment</span> <span class="o">=</span> <span class="n">magnitude_to_moment</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span>

    <span class="n">rotmat</span> <span class="o">=</span> <span class="n">random_rotation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scalar_moment</span> <span class="o">*</span> <span class="p">(</span><span class="n">rotmat</span> <span class="o">*</span> <span class="n">MomentTensor</span><span class="o">.</span><span class="n">_m_unrot</span> <span class="o">*</span> <span class="n">rotmat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">sm</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&quot;/ </span><span class="si">%5.2F</span><span class="s"> </span><span class="si">%5.2F</span><span class="s"> </span><span class="si">%5.2F</span><span class="s"> </span><span class="se">\\\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span>\
    <span class="s">&quot;| </span><span class="si">%5.2F</span><span class="s"> </span><span class="si">%5.2F</span><span class="s"> </span><span class="si">%5.2F</span><span class="s"> |</span><span class="se">\n</span><span class="s">&quot;</span>  <span class="o">%</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span>\
    <span class="s">&quot;</span><span class="se">\\</span><span class="s"> </span><span class="si">%5.2F</span><span class="s"> </span><span class="si">%5.2F</span><span class="s"> </span><span class="si">%5.2F</span><span class="s"> /</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">as_mt</span><span class="p">(</span><span class="n">mt</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mt</span><span class="p">,</span> <span class="n">MomentTensor</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">mt</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">MomentTensor</span><span class="o">.</span><span class="n">from_values</span><span class="p">(</span><span class="n">mt</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MomentTensor</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor">[docs]</a>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Moment tensor object</span>
<span class="sd">       </span>
<span class="sd">    </span>

<span class="sd">    :param m: NumPy matrix in north-east-down convention</span>
<span class="sd">    :param m_up_south_east: NumPy matrix in up-south-east convention</span>
<span class="sd">    :param strike, dip, rake: fault plane angles in [degrees]</span>
<span class="sd">    :param scalar_moment: scalar moment in [Nm]</span>
<span class="sd">    &#39;&#39;&#39;</span> 

    <span class="n">mnn__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">mee__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">mdd__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">mne__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">mnd__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">med__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">strike1__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># read-only</span>
    <span class="n">dip1__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># read-only</span>
    <span class="n">rake1__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># read-only</span>
    <span class="n">strike2__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># read-only</span>
    <span class="n">dip2__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># read-only</span>
    <span class="n">rake2__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># read-only</span>
    <span class="n">moment__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># read-only</span>
    <span class="n">magnitude__</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># read-only</span>

    <span class="n">_flip_dc</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">num</span><span class="o">.</span><span class="n">float</span> <span class="p">)</span>
    <span class="n">_to_up_south_east</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="p">],[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">num</span><span class="o">.</span><span class="n">float</span> <span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">_m_unrot</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">num</span><span class="o">.</span><span class="n">float</span> <span class="p">)</span>
    <span class="n">_u_evals</span><span class="p">,</span> <span class="n">_u_evecs</span> <span class="o">=</span> <span class="n">eigh_check</span><span class="p">(</span><span class="n">_m_unrot</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">random_dc</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scalar_moment</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">magnitude</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.random_dc"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.random_dc">[docs]</a>        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create random oriented double-couple moment tensor</span>

<span class="sd">        The rotations used are uniformly distributed in the space of rotations.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">MomentTensor</span><span class="p">(</span>
            <span class="n">m</span><span class="o">=</span><span class="n">random_dc</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">scalar_moment</span><span class="o">=</span><span class="n">scalar_moment</span><span class="p">,</span> <span class="n">magnitude</span><span class="o">=</span><span class="n">magnitude</span><span class="p">))</span>

    <span class="nd">@classmethod</span></div>
    <span class="k">def</span> <span class="nf">random_mt</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scalar_moment</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">magnitude</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.random_mt"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.random_mt">[docs]</a>        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create random moment tensor</span>

<span class="sd">        Moment tensors produced by this function appear uniformly distributed</span>
<span class="sd">        when shown in a Hudson&#39;s diagram. The rotations used are unifomly</span>
<span class="sd">        distributed in the space of rotations.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">MomentTensor</span><span class="p">(</span>
            <span class="n">m</span><span class="o">=</span><span class="n">random_mt</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">scalar_moment</span><span class="o">=</span><span class="n">scalar_moment</span><span class="p">,</span> <span class="n">magnitude</span><span class="o">=</span><span class="n">magnitude</span><span class="p">))</span>

    <span class="nd">@classmethod</span></div>
    <span class="k">def</span> <span class="nf">from_values</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.from_values"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.from_values">[docs]</a>        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Alternative constructor for moment tensor objects</span>

<span class="sd">        This constructor takes a :py:class:`MomentTensor` object, a tuple, list</span>
<span class="sd">        or NumPy array with 3x3 or 3, 4, 6, or 7 elements to build a Moment</span>
<span class="sd">        tensor object.</span>

<span class="sd">        The *values* argument is interpreted depending on shape as follows::</span>

<span class="sd">            [strike, dip, rake]</span>
<span class="sd">            [strike, dip, rake, magnitude]</span>
<span class="sd">            [mnn, mee, mdd, mne, mnd, med]</span>
<span class="sd">            [mnn, mee, mdd, mne, mnd, med, magnitude]</span>
<span class="sd">            [[mnn, mne, mnd], [mne, mee, med], [mnd, med, mdd]]</span>
<span class="sd">            MomentTensor_object</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">values_to_matrix</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">MomentTensor</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">m_up_south_east</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">strike</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">dip</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">rake</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">scalar_moment</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span></div>
                 <span class="n">mnn</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mee</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mdd</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mne</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mnd</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">med</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">strike1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dip1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rake1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">strike2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dip2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rake2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">magnitude</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">moment</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="n">Object</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_props</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">mxx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">mxx</span> <span class="ow">in</span> <span class="p">(</span><span class="n">mnn</span><span class="p">,</span> <span class="n">mee</span><span class="p">,</span> <span class="n">mdd</span><span class="p">,</span> <span class="n">mne</span><span class="p">,</span> <span class="n">mnd</span><span class="p">,</span> <span class="n">med</span><span class="p">)):</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">symmat6</span><span class="p">(</span><span class="n">mnn</span><span class="p">,</span> <span class="n">mee</span><span class="p">,</span> <span class="n">mdd</span><span class="p">,</span> <span class="n">mne</span><span class="p">,</span> <span class="n">mnd</span><span class="p">,</span> <span class="n">med</span><span class="p">)</span>
        
        <span class="n">strike</span> <span class="o">=</span> <span class="n">d2r</span><span class="o">*</span><span class="n">strike</span>
        <span class="n">dip</span> <span class="o">=</span> <span class="n">d2r</span><span class="o">*</span><span class="n">dip</span>
        <span class="n">rake</span> <span class="o">=</span> <span class="n">d2r</span><span class="o">*</span><span class="n">rake</span>
        
        <span class="k">if</span> <span class="n">m_up_south_east</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_up_south_east</span> <span class="o">*</span> <span class="n">m_up_south_east</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_up_south_east</span><span class="o">.</span><span class="n">T</span>
            
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">strike1</span><span class="p">,</span> <span class="n">dip1</span><span class="p">,</span> <span class="n">rake1</span><span class="p">,</span> <span class="n">strike2</span><span class="p">,</span> <span class="n">dip2</span><span class="p">,</span> <span class="n">rake2</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;strike1, dip1, rake1, strike2, dip2, rake2 are read-only properties&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">moment</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">scalar_moment</span> <span class="o">=</span> <span class="n">moment</span>

            <span class="k">if</span> <span class="n">magnitude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">scalar_moment</span> <span class="o">=</span> <span class="n">magnitude_to_moment</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span>

            <span class="n">rotmat1</span> <span class="o">=</span> <span class="n">euler_to_matrix</span><span class="p">(</span> <span class="n">dip</span><span class="p">,</span> <span class="n">strike</span><span class="p">,</span> <span class="o">-</span><span class="n">rake</span> <span class="p">)</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">rotmat1</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">MomentTensor</span><span class="o">.</span><span class="n">_m_unrot</span> <span class="o">*</span> <span class="n">rotmat1</span> <span class="o">*</span> <span class="n">scalar_moment</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_m</span> <span class="o">=</span> <span class="n">m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">m_evals</span><span class="p">,</span> <span class="n">m_evecs</span> <span class="o">=</span> <span class="n">eigh_check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">m_evecs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">m_evecs</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.</span>

        <span class="n">rotmat1</span> <span class="o">=</span> <span class="p">(</span><span class="n">m_evecs</span> <span class="o">*</span> <span class="n">MomentTensor</span><span class="o">.</span><span class="n">_u_evecs</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="k">if</span> <span class="n">num</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">rotmat1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">rotmat1</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_m_eigenvals</span> <span class="o">=</span> <span class="n">m_evals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_m_eigenvecs</span> <span class="o">=</span> <span class="n">m_evecs</span>
        <span class="k">def</span> <span class="nf">cmp_mat</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">flat</span><span class="p">):</span>
                <span class="n">c</span> <span class="o">=</span> <span class="nb">cmp</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">c</span>
            <span class="k">return</span> <span class="n">c</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rotmats</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span> <span class="p">[</span><span class="n">rotmat1</span><span class="p">,</span> <span class="n">MomentTensor</span><span class="o">.</span><span class="n">_flip_dc</span> <span class="o">*</span> <span class="n">rotmat1</span> <span class="p">],</span> <span class="nb">cmp</span><span class="o">=</span><span class="n">cmp_mat</span> <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mnn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="nd">@mnn.setter</span>
    <span class="k">def</span> <span class="nf">mnn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.mnn"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.mnn">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">()</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">mee</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="nd">@mee.setter</span>
    <span class="k">def</span> <span class="nf">mee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.mee"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.mee">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">()</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">mdd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        
    <span class="nd">@mdd.setter</span>
    <span class="k">def</span> <span class="nf">mdd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.mdd"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.mdd">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">()</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">mne</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="nd">@mne.setter</span>
    <span class="k">def</span> <span class="nf">mne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.mne"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.mne">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">()</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">mnd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

    <span class="nd">@mnd.setter</span>
    <span class="k">def</span> <span class="nf">mnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.mnd"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.mnd">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">()</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">med</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        
    <span class="nd">@med.setter</span>
    <span class="k">def</span> <span class="nf">med</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.med"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.med">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">()</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">strike1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.strike1"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.strike1">[docs]</a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">both_strike_dip_rake</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">dip1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.dip1"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.dip1">[docs]</a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">both_strike_dip_rake</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">rake1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.rake1"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.rake1">[docs]</a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">both_strike_dip_rake</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">strike2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.strike2"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.strike2">[docs]</a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">both_strike_dip_rake</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">dip2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.dip2"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.dip2">[docs]</a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">both_strike_dip_rake</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">rake2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.rake2"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.rake2">[docs]</a>        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">both_strike_dip_rake</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">both_strike_dip_rake</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.both_strike_dip_rake"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.both_strike_dip_rake">[docs]</a>        <span class="sd">&#39;&#39;&#39;Get both possible (strike,dip,rake) triplets.&#39;&#39;&#39;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rotmat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotmats</span><span class="p">:</span>
            <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="p">[</span> <span class="n">r2d</span><span class="o">*</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">matrix_to_euler</span><span class="p">(</span> <span class="n">rotmat</span> <span class="p">)</span> <span class="p">]</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="o">-</span><span class="n">gamma</span><span class="p">)</span> <span class="p">)</span>
        
        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span> <span class="nf">p_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.p_axis"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.p_axis">[docs]</a>        <span class="sd">&#39;&#39;&#39;Get direction of p axis.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_m_eigenvecs</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="nf">t_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.t_axis"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.t_axis">[docs]</a>        <span class="sd">&#39;&#39;&#39;Get direction of t axis.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_m_eigenvecs</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">null_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.null_axis"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.null_axis">[docs]</a>        <span class="sd">&#39;&#39;&#39;Get diretion of the null axis.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_m_eigenvecs</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">eigenvals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.eigenvals"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.eigenvals">[docs]</a>        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Get the eigenvalues of the moment tensor in accending order.</span>

<span class="sd">        :returns: ``(ep, en, et)``</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_m_eigenvals</span>

    <span class="k">def</span> <span class="nf">eigensystem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.eigensystem"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.eigensystem">[docs]</a>        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Get the eigenvalues and eigenvectors of the moment tensor.</span>

<span class="sd">        :returns: ``(ep, en, et, vp, vn, vt)``&#39;&#39;&#39;</span>

        <span class="n">vp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_axis</span><span class="p">()</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">vn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">null_axis</span><span class="p">()</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> 
        <span class="n">vt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_axis</span><span class="p">()</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">ep</span><span class="p">,</span> <span class="n">en</span><span class="p">,</span> <span class="n">et</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_m_eigenvals</span>
        <span class="k">return</span> <span class="n">ep</span><span class="p">,</span> <span class="n">en</span><span class="p">,</span> <span class="n">et</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">vn</span><span class="p">,</span> <span class="n">vt</span>
    
    <span class="k">def</span> <span class="nf">both_slip_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.both_slip_vectors"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.both_slip_vectors">[docs]</a>        <span class="sd">&#39;&#39;&#39;Get both possible slip directions.&#39;&#39;&#39;</span>
        <span class="k">return</span>  <span class="p">[</span><span class="n">rotmat</span><span class="o">*</span><span class="n">cvec</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">)</span> <span class="k">for</span> <span class="n">rotmat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotmats</span> <span class="p">]</span>   
    
    <span class="k">def</span> <span class="nf">m</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.m"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.m">[docs]</a>        <span class="sd">&#39;&#39;&#39;Get plain moment tensor as 3x3 matrix.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">m6</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.m6"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.m6">[docs]</a>        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Get the moment tensor as a six-element array.</span>

<span class="sd">        :returns: ``(mnn, mee, mdd, mne, mnd, med)``</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">to6</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">m_up_south_east</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.m_up_south_east"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.m_up_south_east">[docs]</a>        <span class="sd">&#39;&#39;&#39;Get moment tensor in up-south-east convention as 3x3 matrix.&#39;&#39;&#39;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_up_south_east</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_m</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_up_south_east</span>

    <span class="k">def</span> <span class="nf">m6_up_south_east</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.m6_up_south_east"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.m6_up_south_east">[docs]</a>        <span class="sd">&#39;&#39;&#39;Get moment tensor in up-south-east convention as a six-element array.</span>

<span class="sd">        :returns: ``(muu, mss, mee, mus, mue, mse)``</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">to6</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_up_south_east</span><span class="p">())</span>
    
    <span class="k">def</span> <span class="nf">m_plain_double_couple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.m_plain_double_couple"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.m_plain_double_couple">[docs]</a>        <span class="sd">&#39;&#39;&#39;Get plain double couple with same scalar moment as moment tensor.&#39;&#39;&#39;</span>
        <span class="n">rotmat1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotmats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">rotmat1</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">MomentTensor</span><span class="o">.</span><span class="n">_m_unrot</span> <span class="o">*</span> <span class="n">rotmat1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scalar_moment</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">m</span>

    <span class="k">def</span> <span class="nf">moment_magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.moment_magnitude"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.moment_magnitude">[docs]</a>        <span class="sd">&#39;&#39;&#39;Get moment magnitude of moment tensor.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">moment_to_magnitude</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scalar_moment</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">scalar_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.scalar_moment"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.scalar_moment">[docs]</a>        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Get the scalar moment of the moment tensor (Frobenius norm based)</span>
<span class="sd">        </span>
<span class="sd">        The scalar moment is calculated based on the Euclidean (Frobenius) norm</span>
<span class="sd">        (Silver and Jordan, 1982). The scalar moment returned by this function</span>
<span class="sd">        differs from the standard decomposition based definition of the scalar</span>
<span class="sd">        moment for non-double-couple moment tensors.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">num</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_m_eigenvals</span><span class="p">)</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">moment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scalar_moment</span><span class="p">())</span>

    <span class="nd">@moment.setter</span>
    <span class="k">def</span> <span class="nf">moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.moment"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.moment">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_m</span> <span class="o">*=</span> <span class="n">value</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">moment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">()</span>

    <span class="nd">@property</span></div>
    <span class="k">def</span> <span class="nf">magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">moment_magnitude</span><span class="p">())</span>
    
    <span class="nd">@magnitude.setter</span>
    <span class="k">def</span> <span class="nf">magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.magnitude"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.magnitude">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_m</span> <span class="o">*=</span> <span class="n">magnitude_to_moment</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">moment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
        <span class="n">mexp</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="p">)))))</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_m</span><span class="o">/</span><span class="n">mexp</span>
        <span class="n">s</span> <span class="o">=</span>  <span class="s">&#39;Scalar Moment [Nm]: M0 = </span><span class="si">%g</span><span class="s"> (Mw = </span><span class="si">%3.1f</span><span class="s">)</span><span class="se">\n</span><span class="s">&#39;</span> 
        <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;Moment Tensor [Nm]: Mnn = </span><span class="si">%6.3f</span><span class="s">,  Mee = </span><span class="si">%6.3f</span><span class="s">, Mdd = </span><span class="si">%6.3f</span><span class="s">,</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;                    Mne = </span><span class="si">%6.3f</span><span class="s">,  Mnd = </span><span class="si">%6.3f</span><span class="s">, Med = </span><span class="si">%6.3f</span><span class="s">    [ x </span><span class="si">%g</span><span class="s"> ]</span><span class="se">\n</span><span class="s">&#39;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scalar_moment</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">moment_magnitude</span><span class="p">(),</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">mexp</span><span class="p">)</span>
        
        <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_fault_planes</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">s</span>
    
    <span class="k">def</span> <span class="nf">str_fault_planes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">sdr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">both_strike_dip_rake</span><span class="p">()):</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;Fault plane </span><span class="si">%i</span><span class="s"> [deg]: strike = </span><span class="si">%3.0f</span><span class="s">, dip = </span><span class="si">%3.0f</span><span class="s">, slip-rake = </span><span class="si">%4.0f</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> \
                 <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">sdr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sdr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sdr</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">deviatoric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<div class="viewcode-block" id="MomentTensor.deviatoric"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.deviatoric">[docs]</a>        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Get deviatoric part of moment tensor.</span>
<span class="sd">        </span>
<span class="sd">        Returns a new moment tensor object with zero trace.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">()</span>

        <span class="n">trace_m</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">m_iso</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="n">trace_m</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">,</span> <span class="n">trace_m</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">,</span> <span class="n">trace_m</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">])</span>
        <span class="n">m_devi</span> <span class="o">=</span> <span class="n">m</span> <span class="o">-</span> <span class="n">m_iso</span>
        <span class="n">mt</span> <span class="o">=</span> <span class="n">MomentTensor</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m_devi</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mt</span>

    <span class="k">def</span> <span class="nf">standard_decomposition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
<div class="viewcode-block" id="MomentTensor.standard_decomposition"><a class="viewcode-back" href="../../moment_tensor.html#pyrocko.moment_tensor.MomentTensor.standard_decomposition">[docs]</a>        <span class="sd">&#39;&#39;&#39;Decompose moment tensor into isotropic, DC and CLVD components.</span>

<span class="sd">        Standard decomposition according to e.g. Jost and Herrmann 1989 is</span>
<span class="sd">        returned as::</span>

<span class="sd">            [</span>
<span class="sd">                (moment_iso, ratio_iso, m_iso),</span>
<span class="sd">                (moment_dc, ratio_dc, m_dc),</span>
<span class="sd">                (moment_clvd, ratio_clvd, m_clvd),</span>
<span class="sd">                (moment_devi, ratio_devi, m_devi),</span>
<span class="sd">                (moment, 1.0, m)</span>
<span class="sd">            ]</span>
<span class="sd">        &#39;&#39;&#39;</span>


        <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-6</span>

        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">()</span>

        <span class="n">trace_m</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">m_iso</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="n">trace_m</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">,</span> <span class="n">trace_m</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">,</span> <span class="n">trace_m</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">])</span>
        <span class="n">moment_iso</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">trace_m</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span>

        <span class="n">m_devi</span> <span class="o">=</span> <span class="n">m</span> <span class="o">-</span> <span class="n">m_iso</span>

        <span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">eigh_check</span><span class="p">(</span><span class="n">m_devi</span><span class="p">)</span>

        <span class="n">moment_devi</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">evals</span><span class="p">))</span>
        <span class="n">moment</span> <span class="o">=</span> <span class="n">moment_iso</span> <span class="o">+</span> <span class="n">moment_devi</span>

        <span class="n">iorder</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">evals</span><span class="p">))</span>
        <span class="n">evals_sorted</span> <span class="o">=</span> <span class="n">evals</span><span class="p">[</span><span class="n">iorder</span><span class="p">]</span>
        <span class="n">evecs_sorted</span> <span class="o">=</span> <span class="p">(</span><span class="n">evecs</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">iorder</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

        <span class="k">if</span> <span class="n">moment_devi</span> <span class="o">&lt;</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="n">moment_iso</span><span class="p">:</span>
            <span class="n">signed_moment_dc</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="o">-</span><span class="n">epsilon</span> <span class="o">&lt;=</span>  <span class="o">-</span><span class="n">evals_sorted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">evals_sorted</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.5</span>
            <span class="n">signed_moment_dc</span> <span class="o">=</span> <span class="n">evals_sorted</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span>
                <span class="nb">min</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">evals_sorted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">evals_sorted</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>

        <span class="n">moment_dc</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">signed_moment_dc</span><span class="p">)</span>
        <span class="n">m_dc_es</span> <span class="o">=</span> <span class="n">signed_moment_dc</span> <span class="o">*</span> <span class="n">num</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
        <span class="n">m_dc</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">evecs_sorted</span><span class="p">,</span> <span class="n">num</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">m_dc_es</span><span class="p">,</span> <span class="n">evecs_sorted</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>

        <span class="n">m_clvd</span> <span class="o">=</span> <span class="n">m_devi</span> <span class="o">-</span> <span class="n">m_dc</span>

        <span class="n">moment_clvd</span> <span class="o">=</span> <span class="n">moment_devi</span> <span class="o">-</span> <span class="n">moment_dc</span>

        <span class="n">ratio_dc</span> <span class="o">=</span> <span class="n">moment_dc</span> <span class="o">/</span> <span class="n">moment</span>
        <span class="n">ratio_clvd</span> <span class="o">=</span> <span class="n">moment_clvd</span> <span class="o">/</span> <span class="n">moment</span>
        <span class="n">ratio_iso</span> <span class="o">=</span> <span class="n">moment_iso</span> <span class="o">/</span> <span class="n">moment</span>
        <span class="n">ratio_devi</span> <span class="o">=</span> <span class="n">moment_devi</span> <span class="o">/</span> <span class="n">moment</span>

        <span class="k">return</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">moment_iso</span><span class="p">,</span> <span class="n">ratio_iso</span><span class="p">,</span> <span class="n">m_iso</span><span class="p">),</span>
            <span class="p">(</span><span class="n">moment_dc</span><span class="p">,</span> <span class="n">ratio_dc</span><span class="p">,</span> <span class="n">m_dc</span><span class="p">),</span>
            <span class="p">(</span><span class="n">moment_clvd</span><span class="p">,</span> <span class="n">ratio_clvd</span><span class="p">,</span> <span class="n">m_clvd</span><span class="p">),</span>
            <span class="p">(</span><span class="n">moment_devi</span><span class="p">,</span> <span class="n">ratio_devi</span><span class="p">,</span> <span class="n">m_devi</span><span class="p">),</span>
            <span class="p">(</span><span class="n">moment</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">m</span><span class="p">)]</span>


<span class="k">def</span> <span class="nf">other_plane</span><span class="p">(</span> <span class="n">strike</span><span class="p">,</span> <span class="n">dip</span><span class="p">,</span> <span class="n">rake</span> <span class="p">):</span></div></div>
    <span class="n">mt</span> <span class="o">=</span> <span class="n">MomentTensor</span><span class="p">(</span> <span class="n">strike</span><span class="o">=</span><span class="n">strike</span><span class="p">,</span> <span class="n">dip</span><span class="o">=</span><span class="n">dip</span><span class="p">,</span> <span class="n">rake</span><span class="o">=</span><span class="n">rake</span> <span class="p">)</span>
    <span class="n">both_sdr</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">both_strike_dip_rake</span><span class="p">()</span>
    <span class="n">w</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">sum</span><span class="p">(</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">both_sdr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">strike</span><span class="p">,</span> <span class="n">dip</span><span class="p">,</span> <span class="n">rake</span><span class="p">))</span> <span class="p">]</span> <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">]</span>
    <span class="k">if</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">both_sdr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">both_sdr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Pyrocko v0.3 Manual</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2012, Sebastian Heimann. <img src="http://kinherd.org/pyrocko.png" width="5" height="5">
    </div>
  </body>
</html>